<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Robin Wellmann" />

<meta name="date" content="2017-05-23" />

<title></title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore"><ol start="2" style="list-style-type: decimal">
<li>Marker-based Evaluations</li>
</ol></h1>
<h4 class="author"><em>Robin Wellmann</em></h4>
<h4 class="date"><em>2017-05-23</em></h4>



<p>Marker-based evaluations are an alternative or addition to pedigree based methods. Pedigree based methods enable to estimate the expectations of population specific and individual specific parameters. The realized values, however, deviate from these expectations due to mendelian segregation. In an increasing number of breeds pedigree based methods are being replaced or combined with marker based methods to overcome this limitation. In any case, the goal is to select animals for breeding in a way that accelerates genetic gain, restricts the rate of inbreeeding, and maintains genetic originality of the breed.</p>
<p>All genomic evaluations included in this package are based on haplotype segments. Every individual has two haplotypes: a paternal and a maternal one. A haplotype segment is usually present in many individuals because the individuals have a common ancestor from which the segment originates. It is, however, also possible that two segments are identical by chance. Of course, the likelihood for being identical by chance is the smaller the more markers are included in the segments. Therefor, a part of a chromosome is considered a segment only if it contains at least <code>minSNP&gt;=15</code> consecutive markers.</p>
<p>If a segment is in a region with low recombination rate or high marker density, however, then two segments could be identical even though they originate from an ancestor who lived long time before breed separation. Therefor, segments must have a minimum length which may be measured in centiMorgan (<code>unitL=&quot;cM&quot;</code>) or Mega base pairs (<code>unitL=&quot;Mb&quot;</code>). The minimum length of a segment is often defined as <code>minL=2.0</code> Mb.</p>
<p>The proportion of the genome captured by a segment is usually obtained from it’s length in Mega base pairs (<code>unitP=&quot;Mb&quot;</code>) as the length of the segment divided by the length of the genome.</p>
<p>This section covers the following evaluations based on marker data:</p>
<ul>
<li><a href="#data-preparation">Data Preparation</a>
<ul>
<li><a href="#genotype-file-format">Genotype File Format</a></li>
<li><a href="#marker-map-format">Marker Map Format</a></li>
</ul></li>
<li><a href="#example-data-set">Example Data Set</a></li>
<li><a href="#individual-specific-parameters">Individual Specific Parameters</a>
<ul>
<li><a href="#inbreeding-coefficients">Inbreeding Coefficients</a></li>
<li><a href="#kinship">Kinship</a></li>
<li><a href="#genetic-distances">Genetic Distances</a></li>
<li><a href="#haplotype-frequencies">Haplotype Frequencies</a></li>
<li><a href="#breed-composition">Breed Composition</a></li>
<li><a href="#kinship-at-native-segments">Kinship at Native Segments</a></li>
</ul></li>
<li><a href="#population-specific-parameters">Population Specific Parameters</a>
<ul>
<li><a href="#genetic-diversity">Genetic Diversity</a></li>
<li><a href="#kinship-and-diversity-at-native-segments">Kinship and Diversity at Native Segments</a></li>
</ul></li>
<li><a href="#multi-breed-specific-parameters">Multi-Breed Specific Parameters</a>
<ul>
<li><a href="#kinships-within-and-between-breeds">Kinships Within and Between Breeds</a></li>
<li><a href="#genetic-distances-between-breeds">Genetic Distances Between Breeds</a></li>
<li><a href="#prioritizing-breeds-for-conservation">Prioritizing Breeds for Conservation</a></li>
</ul></li>
</ul>
<p>Note that the calculation of breeding values is not included as there already exist R packages for this purpose.</p>
<div id="data-preparation" class="section level3">
<h3>Data Preparation</h3>
<div id="genotype-file-format" class="section level4">
<h4>Genotype File Format</h4>
<p>In all genotype files, markers must be in rows and individuals in columns. This enables to process one marker at a time without the need to have the whole file in memory. For all functions included in this package</p>
<ul>
<li>there is one file for each chromosome,</li>
<li>genotypes must be phased,</li>
<li>each file has a header and no row names,</li>
<li>cells are separated by blank spaces,</li>
<li>the number of rows is equal to the number of markers from the respective chromosome,</li>
<li>the markers are in the same order as in the map,</li>
<li>there can be some extra columns on the left hand side containing no genotype data,</li>
<li>the text within columns must have no white spaces,</li>
<li>the first rows may contain some comments,</li>
<li>the alleles of an individual are separated by a character, e.g. A/B, 0/1, A|B, A B, or 0 1,</li>
<li>the same two symbols must be used for all markers,</li>
<li>the IDs of the individuals are used as column names and must have no white spaces,</li>
<li>if the blank space is used as separator (i.e. A B, or 0 1), then the ID of each individual must be repeated in the header, so that the number of column names is equal to the number of columns.</li>
</ul>
<p>Example 1:</p>
<pre><code>Note that the marker names are ignored when the file is processed.
I id 6415 6415 2636 2636
M ARS-BFGL-NGS-16466 0 0 1 0 
M ARS-BFGL-NGS-98142 0 1 0 1
M ARS-BFGL-NGS-114208 0 0 1 0</code></pre>
<p>Example 2:</p>
<pre><code>There can be some comments in the first lines
and some extra columns on the left hand side.
Column1 Column2 Column3 6415 2636
M NA dfdf 0/0 1/0
X NA sdfg 0/1 0/1
N NA fgjh 0/0 1/0</code></pre>
</div>
<div id="marker-map-format" class="section level4">
<h4>Marker Map Format</h4>
<p>For all functions reading from genotype files, a marker map must be provided in argument <code>map</code>. This is a data frame or data table with columns including</p>
<p><code>Name</code>: marker name</p>
<p><code>Chr</code>: chromosome number, and possibly</p>
<p><code>Mb</code>: position on the chromosome in Mega base pairs, and</p>
<p><code>cM</code>: position in centiMorgan.</p>
<p>The order of the markers must be the same as in the genotype files.</p>
</div>
</div>
<div id="example-data-set" class="section level3">
<h3>Example Data Set</h3>
<p>All evaluations are demonstrated at the example of cattle data contained in the package. Breed names, years of birth, simulated breeding values, simulated sexes, and herds are provided in data frame <code>Cattle</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;optiSel&quot;</span>)
<span class="kw">data</span>(Cattle)
phen &lt;-<span class="st"> </span>Cattle
<span class="kw">head</span>(phen)</code></pre></div>
<pre><code>##                           Indiv Born  Breed         BV    Sex herd
## 276000101676415 276000101676415 1991 Angler -1.0706066   male &lt;NA&gt;
## 276000108612636 276000108612636 1994 Angler -0.3362574 female    2
## 276000102372349 276000102372349 1986 Angler -2.0735649 female    1
## 276000102379430 276000102379430 1987 Angler  1.5968307   male &lt;NA&gt;
## 276000108826036 276000108826036 1994 Angler  1.0023969   male &lt;NA&gt;
## 276000111902076 276000111902076 1998 Angler -0.2426676   male &lt;NA&gt;</code></pre>
<p>The data frame contains information on 4 breeds:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(phen$Breed)</code></pre></div>
<pre><code>## 
##    Angler Fleckvieh  Holstein   Rotbunt 
##       268       100       100       100</code></pre>
<p>The “Angler” is an endangered German cattle breed, which had been upgraded with Red Holstein (also called “Rotbunt”). The Rotbunt cattle are a subpopulation of the “Holstein” breed. The “Fleckvieh” or Simmental breed is unrelated to the Angler.</p>
<p>The marker map is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(map)
<span class="kw">head</span>(map)</code></pre></div>
<pre><code>##                                    Name Chr Position cM       Mb
## ARS-BFGL-NGS-16466   ARS-BFGL-NGS-16466   1   267940  0 0.267940
## ARS-BFGL-NGS-98142   ARS-BFGL-NGS-98142   1   471078  0 0.471078
## ARS-BFGL-NGS-114208 ARS-BFGL-NGS-114208   1   533815  0 0.533815
## ARS-BFGL-NGS-65067   ARS-BFGL-NGS-65067   1   883895  0 0.883895
## ARS-BFGL-BAC-32722   ARS-BFGL-BAC-32722   1   929617  0 0.929617
## ARS-BFGL-BAC-34682   ARS-BFGL-BAC-34682   1   950841  0 0.950841</code></pre>
<p>This small example data set contains only genotypes from the first parts of the first two chromosomes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(map$Mb, map$Chr, max)</code></pre></div>
<pre><code>##        1        2 
## 40.42745 33.79876</code></pre>
<p>Consequently the results obtained for specific individuals will be rather inaccurate. The genotypes are included in the following files:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir     &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package=</span><span class="st">&quot;optiSel&quot;</span>)
GTfiles &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir, <span class="kw">paste</span>(<span class="st">&quot;Chr&quot;</span>, <span class="kw">unique</span>(map$Chr), <span class="st">&quot;.phased&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre></div>
</div>
<div id="individual-specific-parameters" class="section level3">
<h3>Individual Specific Parameters</h3>
<div id="inbreeding-coefficients" class="section level4">
<h4>Inbreeding Coefficients</h4>
<p>The inbreeding coefficient of an individual is the probability that two alleles chosen at random from the maternal and paternal haplotypes belong to identical segments. This parameter estimates the extent to which the individual may suffer from inbreeding depression and predicts the homogeneity of its offspring. It can be calculated with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Animal &lt;-<span class="st"> </span><span class="kw">segInbreeding</span>(GTfiles, map, <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(Animal)</code></pre></div>
<pre><code>##                           Indiv       Inbr
## 276000101676415 276000101676415 0.04986142
## 276000108612636 276000108612636 0.00000000
## 276000102372349 276000102372349 0.00000000
## 276000102379430 276000102379430 0.02484842
## 276000108826036 276000108826036 0.00000000
## 276000111902076 276000111902076 0.00000000</code></pre>
</div>
<div id="kinship" class="section level4">
<h4>Kinship</h4>
<p>The segment based kinship between two individuals is the probability that two alleles randomly chosen from both individuals belong to segments which are identical in both individuals. A matrix containing the kinship between all pairs of individuals can be computed with function <a href="https://rdrr.io/cran/optiSel/man/segIBD.html">segIBD</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segKIN &lt;-<span class="st"> </span><span class="kw">segIBD</span>(GTfiles, map, <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segKIN[<span class="dv">1</span>:<span class="dv">3</span>,<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>##                 276000101676415 276000108612636 276000102372349
## 276000101676415     0.524930710     0.004341751     0.000000000
## 276000108612636     0.004341751     0.500000000     0.003575048
## 276000102372349     0.000000000     0.003575048     0.500000000</code></pre>
<p>The R code below displays the kinship between the female with ID <code>276000102372349</code> and all genotyped Angler males that have a breeding value larger than 2.0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Males  &lt;-<span class="st"> </span>phen$Indiv[phen$Sex==<span class="st">&quot;male&quot;</span> &amp;<span class="st"> </span>phen$Breed==<span class="st">&quot;Angler&quot;</span> &amp;<span class="st"> </span>phen$BV&gt;<span class="fl">2.0</span>]
segKIN[<span class="kw">rownames</span>(segKIN) %in%<span class="st"> </span>Males, <span class="st">&quot;276000102372349&quot;</span>, drop=<span class="ot">FALSE</span>]</code></pre></div>
<pre><code>##                 276000102372349
## 276000120061822     0.004997202
## 276000120949468     0.008381874
## 276000121243787     0.000000000
## 276000121507437     0.004041023
## 276000121590755     0.000000000</code></pre>
<p>In general, the males that have lowest kinship with the female should be favoured for mating. In this case, however, all kinships are low, so this criterion can be neglected.</p>
</div>
<div id="genetic-distances" class="section level4">
<h4>Genetic Distances</h4>
<p>There are several possibilities to compute a dissimilarity matrix from a similarity matrix. One possibility which seems especially suitable for multidimensional scaling is to define the dissimilarity of individuals <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> as <span class="math display">\[D_{ij}=(-log(b + (1-b)f_{ij}))^a,\]</span> whereby the term <span class="math inline">\(b + (1-b)f_{ij}\)</span> adjusts the kinship between individuals <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> for non-detectable ancestral inbreeding, the function <span class="math inline">\(g(x)=(-log(x))^a\)</span> maps the adjusted kinships from the interval [0,1] to positive real numbers, and parameter <span class="math inline">\(a\)</span> may be chosen such that the stress value is minmized. This can be done with function <a href="https://rdrr.io/cran/optiSel/man/sim2dis.html">sim2dis</a>, whereby <code>b=baseF</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">D     &lt;-<span class="st"> </span><span class="kw">sim2dis</span>(segKIN, <span class="dt">a=</span><span class="fl">6.0</span>, <span class="dt">baseF=</span><span class="fl">0.03</span>, <span class="dt">method=</span><span class="dv">1</span>)
color &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Angler=</span><span class="st">&quot;red&quot;</span>, <span class="dt">Rotbunt=</span><span class="st">&quot;green&quot;</span>, <span class="dt">Fleckvieh=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">Holstein=</span><span class="st">&quot;black&quot;</span>)
col   &lt;-<span class="st"> </span>color[phen[<span class="kw">rownames</span>(D), <span class="st">&quot;Breed&quot;</span>]]
Res   &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(D)
<span class="kw">plot</span>(Res, <span class="dt">pch=</span><span class="dv">18</span>, <span class="dt">col=</span>col, <span class="dt">main=</span><span class="st">&quot;Multidimensional Scaling&quot;</span>, <span class="dt">cex=</span><span class="fl">0.5</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">asp=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="haplotype-frequencies" class="section level4">
<h4>Haplotype Frequencies</h4>
<p>Artificial selection and the substantial genetic drift in populations with small effective sizes have increased the frequencies of various haplotype segments in commercial breeds. Although these segments may contribute to the economic value of a breed, their presences in an endangered breed decreases the conservation value of the breed because they are so common in the species that their conservation does not need to be subsidized.</p>
<p>For individuals with genetic contributions from several breeds, each marker belongs to a haplotype segment that originates from a specific breed. Gene flow is usually from commercial breeds to the endangered breeds but not vice-versa. Thus, if a sufficiently long segment from an endangered breed can also be found in a commercial breed, then it can be concluded that the segment is not native in the endangered breed. Instead, the segment is assigned to the breed in which it has maximum frequency. This can be done with function <a href="https://rdrr.io/cran/optiSel/man/haplofreq.html">haplofreq</a>.</p>
<p>Below, the frequency of each segment from haplotype 2 of Angler 276000101676415 in Rotbunt cattle is plotted with function <a href="https://rdrr.io/cran/optiSel/man/plot.HaploFreq.html">plot</a> (red area).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Haplo &lt;-<span class="st"> </span><span class="kw">haplofreq</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">refBreeds=</span><span class="st">&quot;Rotbunt&quot;</span>,   <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)
<span class="kw">plot</span>(Haplo, <span class="dt">ID=</span><span class="st">&quot;276000101676415&quot;</span>, <span class="dt">hap=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be concluded that the first chromosome originates from Rotbunt cattle or from a closely related breed. In contrast, the second chromosome does not originate from Rotbunt cattle.</p>
<p>This evaluation can be done simulateneously for several reference breeds. Below, the frequencies of each Angler haplotype segment within Rotbunt, Holstein, and Fleckvieh are computed, the results are combined into the single R object <code>Haplo</code> with function <a href="https://rdrr.io/cran/optiSel/man/freqlist.html">freqlist</a>, and plotted with function <a href="https://rdrr.io/cran/optiSel/man/plot.HaploFreq.html">plot</a>. The red area shows the frequency of each haplotype segment in Rotbunt cattle, whereas the black line shows the <em>maximum</em> frequency the segment has in one of the evaluated reference breeds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Haplo &lt;-<span class="st"> </span><span class="kw">freqlist</span>(
  <span class="kw">haplofreq</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">refBreeds=</span><span class="st">&quot;Rotbunt&quot;</span>,   <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>),
  <span class="kw">haplofreq</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">refBreeds=</span><span class="st">&quot;Holstein&quot;</span>,  <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>),
  <span class="kw">haplofreq</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">refBreeds=</span><span class="st">&quot;Fleckvieh&quot;</span>, <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)
  )

<span class="kw">plot</span>(Haplo, <span class="dt">ID=</span><span class="dv">1</span>, <span class="dt">hap=</span><span class="dv">2</span>, <span class="dt">refBreed=</span><span class="st">&quot;Rotbunt&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Hence, most segments from Chromosome 2 have very low frequency in other breeds, so they can be classified to be native for Angler.</p>
<p>The classification of haplotype segments can be done with a single call to function <a href="https://rdrr.io/cran/optiSel/man/haplofreq.html">haplofreq</a>. In this case, argument <code>refBreeds</code> is either the vector with breeds to be used as reference breeds, or the default <code>refBreeds=&quot;others&quot;</code> is used, in which case all breeds with genotypes are used as reference breeds, except <code>thisBreed</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Haplo &lt;-<span class="st"> </span><span class="kw">haplofreq</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">refBreeds=</span><span class="st">&quot;others&quot;</span>, <span class="dt">ubFreq=</span><span class="fl">0.01</span>, <span class="dt">minL=</span><span class="fl">2.5</span>)</code></pre></div>
<p>The result is a list. Component <code>freq</code> is a matrix containing the maximum frequency each haplotype segment has in one of the reference breeds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Haplo$freq[<span class="dv">1</span>:<span class="dv">10</span>,<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>##                     276000101676415 276000101676415 276000108612636
## ARS-BFGL-NGS-16466             0.25               0               0
## ARS-BFGL-NGS-98142             0.25               0               0
## ARS-BFGL-NGS-114208            0.25               0               0
## ARS-BFGL-NGS-65067             0.25               0               0
## ARS-BFGL-BAC-32722             0.25               0               0
## ARS-BFGL-BAC-34682             0.25               0               0
## ARS-BFGL-NGS-3964              0.25               0               0
## ARS-BFGL-NGS-98203             0.25               0               0
## ARS-BFGL-BAC-2376              0.25               0               0
## ARS-BFGL-BAC-31722             0.25               0               0</code></pre>
<p>Component <code>match</code> is a matrix containing for each segment the first letter of the name of the breed in which the segment has maximum frequency. If the frequency of the segment is smaller than <code>ubFreq=0.01</code> in all reference breeds, then the segment is classified to be native and coded as <code>1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Haplo$match[<span class="dv">1</span>:<span class="dv">10</span>,<span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>##                     276000101676415 276000101676415 276000108612636
## ARS-BFGL-NGS-16466  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-NGS-98142  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-NGS-114208 &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-NGS-65067  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-BAC-32722  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-BAC-34682  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-NGS-3964   &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-NGS-98203  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-BAC-2376   &quot;R&quot;             &quot;1&quot;             &quot;1&quot;            
## ARS-BFGL-BAC-31722  &quot;R&quot;             &quot;1&quot;             &quot;1&quot;</code></pre>
<p>If individuals are genotyped for many markers, then the working memory could become a limitation. This can be avoided by writing the results to files. Results will be written to files if argument <code>w.dir</code> is defined as the name of a directory. In this case function <a href="https://rdrr.io/cran/optiSel/man/haplofreq.html">haplofreq</a> returns a data frame with file names:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wdir  &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;HaplotypeEval&quot;</span>)
wfile &lt;-<span class="st"> </span><span class="kw">haplofreq</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>, <span class="dt">w.dir=</span>wdir)</code></pre></div>
</div>
<div id="breed-composition" class="section level4">
<h4>Breed Composition</h4>
<p>Mating decisions should not only depend on the breeding value of the male and the kinship between male and female, but also on the genetic contribution of the male from foreign breeds. Many endangered breeds have been graded up with commercial high-yielding breeds. These increasing migrant contributions displace the original genetic background of the endangered breed, decrease the genetic contribution from native ancestors, and reduce the conservation value of the breed. The breed composition of individuals can be estimated with function <a href="https://rdrr.io/cran/optiSel/man/segBreedComp.html">segBreedComp</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Comp  &lt;-<span class="st"> </span><span class="kw">segBreedComp</span>(Haplo$match, map)
<span class="kw">head</span>(Comp[,-<span class="dv">1</span>])</code></pre></div>
<pre><code>##                    native            F          H          R
## 276000101676415 0.6820668 0.0000000000 0.06420559 0.25372765
## 276000108612636 0.5952110 0.0392385937 0.23581096 0.12973943
## 276000102372349 0.8953642 0.0647239060 0.02188978 0.01802207
## 276000102379430 0.5127613 0.0004341256 0.18018789 0.30661670
## 276000108826036 0.3338797 0.0031128187 0.23518540 0.42782203
## 276000111902076 0.3158735 0.0000000000 0.24816876 0.43595772</code></pre>
<p>The average breed composition of Angler cattle is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Average &lt;-<span class="st"> </span><span class="kw">apply</span>(Comp[,-<span class="dv">1</span>],<span class="dv">2</span>,mean)
<span class="kw">round</span>(Average, <span class="dv">3</span>)</code></pre></div>
<pre><code>## native      F      H      R 
##  0.477  0.020  0.237  0.266</code></pre>
<p>Since Red Holstein is a subpopulation of Holstein cattle, their contributions should be added. Thus, the average contribution of Angler cattle from Holstein is 0.503, the contribution from Fleckvieh is only 0.02, and the native contribution is 0.477. This is in good accordance with pedigree-based results</p>
</div>
<div id="kinship-at-native-segments" class="section level4">
<h4>Kinship at Native Segments</h4>
<p>Since animals with low migrant contributions tend to be related, the inbreeding level could increase considerably when introgressed genetic material is removed from the population. This could be avoided by restricting the increase in kinship at native haplotype segments in the population. Matrix <code>segKINatN</code> containing the kinship of individuals at native haplotype segments can be calculated from the results of function <a href="https://rdrr.io/cran/optiSel/man/segIBDatN.html">segIBDatN</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fD &lt;-<span class="st"> </span><span class="kw">segIBDatN</span>(GTfiles, phen, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">ubFreq=</span><span class="fl">0.01</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segKINatN &lt;-<span class="st"> </span>fD$segIBDandN/fD$segN
segKINatN[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)]</code></pre></div>
<pre><code>##                 276000108612636 276000102379430 276000108826036
## 276000108612636      0.65929193      0.09438978        0.000000
## 276000102379430      0.09438978      0.88219967        0.000000
## 276000108826036      0.00000000      0.00000000        0.758341</code></pre>
</div>
</div>
<div id="population-specific-parameters" class="section level3">
<h3>Population Specific Parameters</h3>
<div id="genetic-diversity" class="section level4">
<h4>Genetic Diversity</h4>
<p>The genetic diversity of a population is the probability that two alleles chosen at random from the population belong to identical segments. It is one minus the average segment based kinship of the individuals. Thus, it can be computed as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">keep &lt;-<span class="st"> </span>phen$Indiv[phen$Breed==<span class="st">&quot;Angler&quot;</span>]
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(segKIN[keep, keep])</code></pre></div>
<pre><code>## [1] 0.9431438</code></pre>
<p>The diversity of this population is high due to historic introgression with other breeds.</p>
</div>
<div id="kinship-and-diversity-at-native-segments" class="section level4">
<h4>Kinship and Diversity at Native Segments</h4>
<p>The kinship at native segments in the population is the probability that two alleles chosen at random from the population belong to identical segments, given that the segments originate from native founders. Since it is defined as a conditional probability, it can be computed as the ratio of two means. The kinship at native segments is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(fD$segIBDandN)/<span class="kw">mean</span>(fD$segN)</code></pre></div>
<pre><code>## [1] 0.06695171</code></pre>
<p>The genetic diversity at native segments is one minus the kinship at native segments. Thus, it can be calculated as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(fD$segIBDandN)/<span class="kw">mean</span>(fD$segN)</code></pre></div>
<pre><code>## [1] 0.9330483</code></pre>
<p>The diversity at native segments is high. This could have several reasons:</p>
<ul>
<li><p>breeds that have been used for introgression are missing in the data set, so contributions from these breeds were wrongly classified as native and contribute to the diversity at native segments,</p></li>
<li><p>the minimum lentgh of haplotype segments is too high or the marker density is too low, so that short introgressed segments cannot be classified to be non-native.</p></li>
<li><p>the diversity at native segments is indeed high.</p></li>
</ul>
<p>In this case, an introgressed breed, the Norwegian Red, is missing in the data set. A high diversity at native segments is important if a goal of the breeding program is to remove introgressed genetic material from the population. Without maintenance of a high diversity at native segments, inbreeding coefficients will soon rise to an unreasonable level.</p>
</div>
</div>
<div id="multi-breed-specific-parameters" class="section level3">
<h3>Multi-Breed Specific Parameters</h3>
<p>Most evaluations for multiple breeds with segment based methods require high density marker genotypes that enable the detection of short haplotype segments that originate from common ancestors who lived before breed separation. Hence, the examples shown below are only illustrative.</p>
<div id="kinships-within-and-between-breeds" class="section level4">
<h4>Kinships Within and Between Breeds</h4>
<p>Average segment based kinships between and within breeds can be computed with function <a href="https://rdrr.io/cran/optiSel/man/opticomp.html">opticomp</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segKIN  &lt;-<span class="st"> </span><span class="kw">segIBD</span>(GTfiles, map, <span class="dt">minSNP=</span><span class="dv">20</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Breed   &lt;-<span class="st"> </span>phen[<span class="kw">rownames</span>(segKIN),<span class="st">&quot;Breed&quot;</span>]
CoreSet &lt;-<span class="st"> </span><span class="kw">opticomp</span>(segKIN, Breed)
<span class="kw">round</span>(CoreSet$f, <span class="dv">3</span>)</code></pre></div>
<pre><code>##           Angler Fleckvieh Holstein Rotbunt
## Angler     0.057     0.006    0.046   0.046
## Fleckvieh  0.006     0.073    0.005   0.005
## Holstein   0.046     0.005    0.112   0.094
## Rotbunt    0.046     0.005    0.094   0.111</code></pre>
<p>It can be seen that inbreeding is lowest in Angler cattle and highest in Rotbunt cattle. The kinship between Holstein and Rotbunt is almost as high as the kinships within the breeds, so both breeds are closely related. In contrast, Fleckvieh is only distantly related to all other breeds included in the data set.</p>
</div>
<div id="genetic-distances-between-breeds" class="section level4">
<h4>Genetic Distances Between Breeds</h4>
<p>Genetic distances between breeds can be computed from the kinships between breeds. There are various possibilities to define genetic distances and the method of choice depends on the intended use. The distance between two breed <span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span>, defined as <span class="math display">\[\Delta_{bl} = \sqrt{\frac{f_{bb}+f_{ll}}{2}-f_{bl}}\]</span> can be considered an estimate of the expected differences in population means for a neutral polygenic trait <span class="citation">(Wellmann, Bennewitz, and Meuwissen 2014)</span>. It can be obtained as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(CoreSet$Dist, <span class="dv">3</span>)</code></pre></div>
<pre><code>##           Angler Fleckvieh Holstein Rotbunt
## Angler     0.000     0.242    0.196   0.193
## Fleckvieh  0.242     0.000    0.295   0.295
## Holstein   0.196     0.295    0.000   0.130
## Rotbunt    0.193     0.295    0.130   0.000</code></pre>
</div>
<div id="prioritizing-breeds-for-conservation" class="section level4">
<h4>Prioritizing Breeds for Conservation</h4>
<p>Since resources available for conservation are limited, prioritizing breeds for conservation is of high importance to halt the erosion of genetic diversity observed in livestock species. This requires to estimate conservation values of breeds.</p>
<p>In the core set approach, a hypothetical subdivided population is considered, consisting of individuals from various breeds. This population is called the core set. The contributions of each breed to the core set are determined such that the diversity of the core set is maximized. The conservation value of a particular breed measures how much the diversity decreases if the breed is removed from the core set.</p>
<p>Function <a href="https://rdrr.io/cran/optiSel/man/opticomp.html">opticomp</a> can be used to compute the contributions of the breeds to a core set with maximum diversity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CoreSet &lt;-<span class="st"> </span><span class="kw">opticomp</span>(segKIN, Breed)
CoreSet$bc</code></pre></div>
<pre><code>##     Angler  Fleckvieh   Holstein    Rotbunt 
## 0.47908531 0.42425265 0.04434691 0.05231513</code></pre>
<p>The Rotbunt cattle have only a small contribution to the core set, as their genes are already present in Angler and Holstein cattle. For this core set the diversity is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CoreSet$value</code></pre></div>
<pre><code>## [1] 0.9656585</code></pre>
<p>Removing the Angler cattle from the core set</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CoreSet &lt;-<span class="st"> </span><span class="kw">opticomp</span>(segKIN, Breed, <span class="dt">ub=</span><span class="kw">c</span>(<span class="dt">Angler=</span><span class="dv">0</span>))
CoreSet$bc</code></pre></div>
<pre><code>##    Angler Fleckvieh  Holstein   Rotbunt 
## 0.0000000 0.5910616 0.1876452 0.2212932</code></pre>
<p>increases the Rotbunt and Holstein contributions, and decreases the diversity of the core set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CoreSet$value</code></pre></div>
<pre><code>## [1] 0.9548693</code></pre>
</div>
</div>
<div id="references" class="section level3 unnumbered">
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Wellmann2014">
<p>Wellmann, R., J. Bennewitz, and T. H. Meuwissen. 2014. “A Unified Approach to Characterize and Conserve Adaptive and Neutral Genetic Diversity in Subdivided Populations.” <em>Genetical Research (Camb)</em> 96.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
